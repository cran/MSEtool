<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Quang Huynh (q.huynh@oceans.ubc.ca)" />

<meta name="date" content="2020-05-04" />

<title>2a. Mathematical description of the SRA model</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>





<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">2a. Mathematical description of the SRA model</h1>
<h4 class="author">Quang Huynh (<a href="mailto:q.huynh@oceans.ubc.ca" class="email">q.huynh@oceans.ubc.ca</a>)</h4>
<h4 class="date">2020-05-04</h4>


<div id="TOC">
<ul>
<li><a href="#selectivity-and-mortality"><span class="toc-section-number">1</span> Selectivity and mortality</a></li>
<li><a href="#survey-selectivity"><span class="toc-section-number">2</span> Survey selectivity</a></li>
<li><a href="#initial-population-distribution"><span class="toc-section-number">3</span> Initial population distribution</a></li>
<li><a href="#dynamics-equations"><span class="toc-section-number">4</span> Dynamics equations</a></li>
<li><a href="#catch-at-age"><span class="toc-section-number">5</span> Catch at age</a></li>
<li><a href="#catch-at-length"><span class="toc-section-number">6</span> Catch-at-length</a></li>
<li><a href="#survey"><span class="toc-section-number">7</span> Survey</a></li>
<li><a href="#likelihoods"><span class="toc-section-number">8</span> Likelihoods</a></li>
<li><a href="#estimated-parameters"><span class="toc-section-number">9</span> Estimated parameters</a>
<ul>
<li><a href="#selectivity"><span class="toc-section-number">9.1</span> Selectivity</a></li>
<li><a href="#fishing-mortality"><span class="toc-section-number">9.2</span> Fishing mortality</a></li>
<li><a href="#index-catchability"><span class="toc-section-number">9.3</span> Index catchability</a></li>
<li><a href="#other-parameters"><span class="toc-section-number">9.4</span> Other parameters</a></li>
</ul></li>
<li><a href="#additional-resources"><span class="toc-section-number">10</span> Additional resources</a></li>
</ul>
</div>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "all"} } });
</script>
<style type="text/css">

body{ /* Normal  */
   font-size: 12px;
}
td {  /* Table  */
   font-size: 8px;
}
h1 { /* Header 1 */
 font-size: 18px;
 color: DarkBlue;
}
h2 { /* Header 2 */
 font-size: 15px;
 color: DarkBlue;
}
h3 { /* Header 3 */
 font-size: 14px;
 color: DarkBlue;
}
code.r{ /* Code block */
  font-size: 10px;
}
pre { /* Code block */
  font-size: 10px
}
</style>
<p><br></p>
<div id="selectivity-and-mortality" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Selectivity and mortality</h1>
<p>For fleets, selectivity is defined by blocks (indexed by <span class="math inline">\(b\)</span>) which can then be assigned to any fleet <span class="math inline">\(f\)</span> and year <span class="math inline">\(y\)</span> to allow for time-varying selectivity. By default, each fleet is assigned to its own block for all years (no time-varying selectivity).</p>
<p>For flat-topped selectivity in block <span class="math inline">\(b\)</span>, two parameters are used and expressed in terms of length units: the length of 5% selectivity (<span class="math inline">\(L^5_b\)</span>) and the length of full selectivity <span class="math inline">\(L^{\textrm{FS}}_b\)</span>. For dome selectivity, a third parameter, the selectivity at <span class="math inline">\(L_{\infty}\)</span>, <span class="math inline">\(V^{L_{\infty}}_b\)</span> is also used. Length-based selectivity is converted to age-based selectivity in the age-structured model as:</p>
<p><span class="math display">\[ v_{y,a,b} = 
\begin{cases}
2^{-[(L_{y,a} - L^{\textrm{FS}}_b)/(\sigma^{\textrm{asc}}_b)]^2} &amp; \textrm{if } L_{y,a} &lt; L^{\textrm{FS}}_b\\ 
1 &amp; \textrm{if logistic and } L_{y,a} \ge L^{\textrm{FS}}_b,\\
2^{-[(L_{y,a} - L^{\textrm{FS}}_b)/(\sigma^{\textrm{des}}_b)]^2} &amp; \textrm{if dome and } L_{y,a} \ge L^{\textrm{FS}}_b
\end{cases}
\]</span></p>
<p>where <span class="math inline">\(L_{y,a}\)</span> is the mean length-at-age and <span class="math inline">\(\sigma^{\textrm{asc}}_b = (L^5_b - L^{\textrm{FS}}_b)/\sqrt{-\log_2(0.05)}\)</span> and <span class="math inline">\(\sigma^{\textrm{des}}_b = (L_{\infty} - L^{\textrm{FS}}_b)/\sqrt{-\log_2(V^{L_{\infty}}_b)}\)</span> control the shape of the ascending and descending limbs, respectively, of the selectivity function. In this parameterization, length-based selectivity is constant over time. The corresponding age-based selectivity within each block is constant so long as growth is not time-varying.</p>
<p>Selectivity can also be parameterized where <span class="math inline">\(v_{y,a,b}\)</span> are free independent parameters. In this case, selectivity does not vary among years.</p>
<p>Total mortality <span class="math inline">\(Z\)</span> in year <span class="math inline">\(y\)</span> and for age <span class="math inline">\(a\)</span> is the sum of fishing mortality <span class="math inline">\(F\)</span> from all fleets and natural mortality <span class="math inline">\(M\)</span>,</p>
<p><span class="math display">\[ Z_{y,a} = M_{y,a} + \Sigma_f v_{y,a,f} F_{y,f},\]</span></p>
<p>where <span class="math inline">\(v_{y,a,f}\)</span> is the fleet selectivity after assigning blocks to fleets.</p>
</div>
<div id="survey-selectivity" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Survey selectivity</h1>
<p>Survey selectivity is constant over time and is denoted as <span class="math inline">\(v_{a,s}\)</span> with either logistic, dome, or free parameterizations.</p>
</div>
<div id="initial-population-distribution" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Initial population distribution</h1>
<p>The population age distribution in the first year of the model <span class="math inline">\(y=1\)</span> is in equilibrium where <span class="math display">\[ N_{1,a} = 
\begin{cases}
      R^{\textrm{eq}} \exp(-\Sigma_{i=1}^{a-1}Z^{\textrm{eq}}_i) &amp; a = 1, \ldots, A-1\\
      \dfrac{R^{\textrm{eq}} \exp(-\Sigma_{i=1}^{a-1}Z^{\textrm{eq}}_i)}{1 - \exp(-Z^{\textrm{eq}}_A)} &amp; a = A,
\end{cases}
\]</span> where the <span class="math inline">\(R^{\textrm{eq}}\)</span> is the equilibrium recruitment and <span class="math inline">\(Z^{\textrm{eq}}_a = M_{1,a} + \Sigma_f v_{1,a,f} F^{\textrm{eq}}_f\)</span> is the equilibrium total mortality rate. Unfished conditions are modeled by setting <span class="math inline">\(F^{\textrm{eq}}_f = 0\)</span>. To estimate <span class="math inline">\(F^{\textrm{eq}}_f\)</span>, the corresponding equilibrium catch in weight <span class="math inline">\(\tilde{C}^{\textrm{eq}}_f\)</span> prior to the first year of the model should be provided. In the equilibrium yield curve, <span class="math inline">\(F^{\textrm{eq}}_f\)</span> would be the fishing mortality corresponding to fishing at <span class="math inline">\(F^{\textrm{eq}}_f\)</span>. Once <span class="math inline">\(Z^{\textrm{eq}}_a\)</span> is obtained, then the equilibrium recruitment is calculated as:</p>
<p><span class="math display">\[ R^{\textrm{eq}} = 
\begin{cases}
      \dfrac{\alpha^{\textrm{B}}\phi^{\textrm{eq}} - 1}{\beta^{\textrm{B}}\phi^{\textrm{eq}}} &amp; \textrm{if Beverton-Holt stock-recruit relationship}\\
      \dfrac{\log(\alpha^{\textrm{R}}\phi^{\textrm{eq}})}{\beta^{\textrm{R}}\phi^{\textrm{eq}}} &amp; \textrm{if Ricker stock-recruit relationship}
\end{cases},
\]</span> where <span class="math inline">\(\phi^{\textrm{eq}}\)</span> is the spawners-per-recruit when the mortality is <span class="math inline">\(Z^{\textrm{eq}}_a\)</span>. From steepness <span class="math inline">\(h\)</span>, <span class="math inline">\(\alpha^{\textrm{B}} = \frac{4h}{(1-h)\phi_0}\)</span>, <span class="math inline">\(\beta^{\textrm{B}} = \frac{5h-1}{(1-h)B^S_0}\)</span>, <span class="math inline">\(\alpha^{\textrm{R}} = \frac{(5h)^{1.25}}{\phi_0}\)</span>, <span class="math inline">\(\beta^{\textrm{R}} = \frac{\log(5h)}{B^S_0}\)</span>, where <span class="math inline">\(\phi_0\)</span> and <span class="math inline">\(B^S_0\)</span> are unfished spawners-per-recruit and unfished spawning biomass, respectively.</p>
</div>
<div id="dynamics-equations" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Dynamics equations</h1>
<p>After setting the equilibrium population age distribution in the first year of the model, the population abundance <span class="math inline">\(N_{y,a}\)</span> in subsequent years is <span class="math display">\[ N_{y,a} =
\begin{cases}
      R_y &amp; a = 1\\
      N_{y-1,a-1} \exp(-Z_{y-1,a-1}) &amp; a = 2, \ldots, A - 1,\\
      N_{y-1,a-1} \exp(-Z_{y-1,a-1}) + N_{y-1,a} \exp(-Z_{y-1,a}) &amp; a = A
\end{cases}
\]</span> where <span class="math inline">\(R_y\)</span> is the recruitment and <span class="math inline">\(A\)</span> is the maximum-age as the plus-group. Recruitment is modelled as <span class="math display">\[ R_y = 
\begin{cases}
      \dfrac{\alpha^{\textrm{BH}} B^S_{y-1}}{1 + \beta^{\textrm{BH}}B^S_{y-1}} \exp(\delta_y - 0.5 \tau^2) &amp; \textrm{if Beverton-Holt stock-recruit relationship}\\
      \alpha^{\textrm{Ricker}} B^S_{y-1} \exp(-\beta^{\textrm{Ricker}} B^S_{y-1})\exp(\delta_y - 0.5 \tau^2) &amp; \textrm{if Ricker stock-recruit relationship}
\end{cases},
\]</span> where <span class="math inline">\(\delta_y\)</span> are recruitment deviates and <span class="math inline">\(\tau\)</span> is the standard deviation of the deviates.</p>
<p>The spawning biomass is <span class="math inline">\(B^S_y\)</span> is <span class="math display">\[B^S_y = \sum_a w_{y,a} m_{y,a} N_{y,a},\]</span> where <span class="math inline">\(m_{y,a}\)</span> and <span class="math inline">\(w_{y,a}\)</span> are the maturity at age and weight at age, respectively.</p>
</div>
<div id="catch-at-age" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Catch at age</h1>
<p>The catch (in numbers) <span class="math inline">\(C^N\)</span> at age for fleet <span class="math inline">\(f\)</span> is <span class="math display">\[ C^N_{y,a,f} = \dfrac{v_{y,a,f} F_{y,f}}{Z_{y,a}} N_{y,a} (1 - \exp[-Z_{y,a}]).\]</span></p>
<p>If the model is conditioned on catch, then <span class="math inline">\(F_{y,f}\)</span> can be estimated as parameters or solved iteratively to match the observed catch. If the model is conditioned on effort, then <span class="math display">\[ F_{y,f} = q_f E_{y,f},\]</span> where <span class="math inline">\(E_{y,f}\)</span> is the observed effort and <span class="math inline">\(q_f\)</span> is the scaling coefficient.</p>
</div>
<div id="catch-at-length" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> Catch-at-length</h1>
<p>The catch at length is calculated assuming a normally distributed length-at-age <span class="math inline">\(P(\ell,a)\)</span>, where <span class="math display">\[ C^N_{y,\ell,f} = \sum_a C^N_{y,a,f} P(\ell|a) \]</span> and</p>
<p><span class="math display">\[ P(\ell|a) = 
\begin{cases}
      \phi(L&#39;_{\ell+1}) &amp; \ell = 1\\
      \phi(L&#39;_{\ell+1}) - \phi(L&#39;_\ell) &amp; \ell = 2, \ldots, L - 1,\\
      1 -\phi(L&#39;_\ell) &amp; \ell = L
\end{cases}
\]</span> with <span class="math inline">\(L&#39;_{\ell}\)</span> as the length at the lower boundary of length bin <span class="math inline">\(\ell\)</span> and <span class="math inline">\(\phi(L&#39;_{\ell})\)</span> as the cumulative distribution function of a normal variable with mean <span class="math inline">\(\tilde{L}_{y,a}\)</span> (the expected mean length at age <span class="math inline">\(a\)</span>) and standard deviation <span class="math inline">\(\tilde{L}_{y,a} \times CV^L\)</span> (<span class="math inline">\(CV^L\)</span> is the coefficient of variation in mean length at age).</p>
<p>The catch in weight <span class="math inline">\(\tilde{C}\)</span> is <span class="math display">\[ \tilde{C}_{y,f} = \sum_a C^N_{y,a,f} w_{y,a}.\]</span></p>
<p>The mean length of the catch <span class="math inline">\(\bar{L}_{y,f}\)</span> is <span class="math display">\[ \bar{L}_{y,f} = \dfrac{\sum_{\ell} L_{\ell} C^N_{y,\ell,f}}{\sum_{\ell} C^N_{y,\ell,f}},\]</span> where <span class="math inline">\(L_\ell\)</span> is the midpoint of the length bin <span class="math inline">\(\ell\)</span>.</p>
<p>The proportion of the catch-at-age is <span class="math display">\[ p_{y,a,f} = \dfrac{C^N_{y,a,f}}{\sum_a C^N_{y,a,f}}.\]</span></p>
<p>The proportion of the catch-at-length is <span class="math display">\[ p_{y,\ell,f} = \dfrac{C^N_{y,\ell,f}}{\sum_{\ell}C^N_{y,\ell,f}}.\]</span></p>
</div>
<div id="survey" class="section level1" number="7">
<h1 number="7"><span class="header-section-number">7</span> Survey</h1>
<p>If the <span class="math inline">\(s^{\textrm{th}}\)</span> survey is biomass-based, then the survey value <span class="math inline">\(I_{y,s}\)</span> is calculated as <span class="math display">\[ I_{y,s} = q_s \sum_a v_{y,a,s} N_{y,a} w_{y,a}, \]</span> where <span class="math inline">\(q\)</span> is the scaling coefficient and <span class="math inline">\(s\)</span> indexes survey.</p>
<p>If the survey is abundance-based, then <span class="math display">\[ I_{y,s} = q_s \sum_a v_{y,a,s} N_{y,a} . \]</span></p>
<p>The proportion-at-age vulnerable to the survey is <span class="math display">\[ p_{y,a,s} = \dfrac{v_{a,s}N_{y,a}}{\sum_a v_{a,s}N_{y,a}}.\]</span></p>
<p>The proportion-at-length vulnerable to the survey is <span class="math display">\[ p_{y,\ell,s} = \dfrac{\sum_a v_{a,s} N_{y,a} P(\ell|a)}{\sum_{\ell} \sum_a v_{a,s} N_{y,a} P(\ell|a)}.\]</span></p>
</div>
<div id="likelihoods" class="section level1" number="8">
<h1 number="8"><span class="header-section-number">8</span> Likelihoods</h1>
<p>If the model is conditioned on catch and fishing mortality rates are estimated parameters, then the log-likelihood component <span class="math inline">\(\Lambda_1\)</span> of the catch is <span class="math display">\[\Lambda_1 = \sum_f \left[\lambda^{\tilde{C}}_f \sum_y \left(-\log(0.01) - \dfrac{[\log(\tilde{C}^{\textrm{obs}}_{y,f}) - \log(\tilde{C}^{\textrm{pred}}_{y,f})]^2}{2 \times 0.01^2}\right)\right],\]</span></p>
<p>where <span class="math inline">\(\textrm{obs}\)</span> and <span class="math inline">\(\textrm{pred}\)</span> indicate observed and predicted quantities, respectively, and <span class="math inline">\(\lambda\)</span> are likelihood weights. With a small standard deviation for the catch likelihood relative to the variance in other likelihood components, the predicted catch should match the observed catch.</p>
<p>The log-likelihood component <span class="math inline">\(\Lambda_2\)</span> of survey data is <span class="math display">\[\Lambda_2 = \sum_s \left[ \lambda^I_s \sum_y \left(-\log(\sigma_{y,s}) - \dfrac{[\log(I^{\textrm{obs}}_{y,s}) - \log(I^{\textrm{pred}}_{y,s})]^2}{2\sigma_{y,s}^2}\right) \right].\]</span></p>
<p>The log-likelihood component <span class="math inline">\(\Lambda_3\)</span> of catch-at-age data is <span class="math display">\[\Lambda_3 = \sum_f \lambda^A_f \left[\sum_y O^A_{y,f} \sum_a p^{\textrm{obs}}_{y,a,f} \log(p^{\textrm{pred}}_{y,a,f})\right],\]</span> where <span class="math inline">\(O^A\)</span> is the annual sample sizes for the age compositions.</p>
<p>The log-likelihood component <span class="math inline">\(\Lambda_4\)</span> of catch-at-length data is <span class="math display">\[\Lambda_4 = \sum_f \lambda^L_f \left[ \sum_y O^L_{y,f} \sum_{\ell} p^{\textrm{obs}}_{y,\ell,f} \log(p^{\textrm{pred}}_{y,\ell,f})\right]\]</span> where <span class="math inline">\(O^L\)</span> is the annual sample sizes for the length compositions.</p>
<p>The log-likelihood component <span class="math inline">\(\Lambda_5\)</span> of observed mean lengths in the catch is <span class="math display">\[\Lambda_5 = \sum_f \lambda^{\bar{L}}_f\left[ \sum_y \left(-\log(\omega_f) - \dfrac{[\bar{L}^{\textrm{obs}}_{y,f} - \bar{L}^{\textrm{pred}}_{y,f}]^2}{2 \omega^2_f}\right)\right],\]</span> where <span class="math inline">\(\omega_f\)</span> is the standard deviation of mean lengths.</p>
<p>The log-likelihood component <span class="math inline">\(\Lambda_6\)</span> of annual estimated recruitment deviates <span class="math inline">\(\delta_y\)</span> in log space is <span class="math display">\[\Lambda_6 = \Sigma_y\left(-\log(\tau) - \dfrac{\delta_y^2}{2 \tau^2}\right),\]</span> where <span class="math inline">\(\tau\)</span> is the standard deviation of recruitment deviates.</p>
<p>The log-likelihood component <span class="math inline">\(\Lambda_7\)</span> of the equilibrium catch is <span class="math display">\[\Lambda_7 = \sum_f \lambda^{\tilde{C}}_f \left(-\log(0.01) - \dfrac{[\log(\tilde{C}^{\textrm{eq,obs}}_f) - \log(\tilde{C}^{\textrm{eq,pred}}_f)]^2}{2 \times 0.01^2}\right),\]</span></p>
<p>The log-likelihood component <span class="math inline">\(\Lambda_8\)</span> of the survey proportion-at-age data is <span class="math display">\[\Lambda_8 = \sum_s \lambda^{IA}_s \left[\sum_y O^{IA}_{y,s} \sum_a p^{\textrm{obs}}_{y,a,s} \log(p^{\textrm{pred}}_{y,a,s})\right],\]</span> where <span class="math inline">\(O^{IA}\)</span> is the annual sample sizes for the survey age compositions.</p>
<p>The log-likelihood component <span class="math inline">\(\Lambda_9\)</span> of the surey proportion-at-length data is <span class="math display">\[\Lambda_9 = \sum_s \lambda^{IL}_s \left[ \sum_y O^{IL}_{y,s} \sum_{\ell} p^{\textrm{obs}}_{y,\ell,s} \log(p^{\textrm{pred}}_{y,\ell,s})\right]\]</span> where <span class="math inline">\(O^{IL}\)</span> is the annual sample sizes for the survey length compositions.</p>
<p>The total log-likelihood <span class="math inline">\(\textrm{LL}\)</span> to be maximized is <span class="math display">\[\textrm{LL} = \sum_{i=1}^9\Lambda_i.\]</span></p>
</div>
<div id="estimated-parameters" class="section level1" number="9">
<h1 number="9"><span class="header-section-number">9</span> Estimated parameters</h1>
<p>The estimated parameters, denoted in this section as <span class="math inline">\(x\)</span>, are unconstrained over all real numbers and then transformed in order to constrain the corresponding model parameters. For optimization, the transformation is also designed to reduce the scale of all estimated parameters to within an order of magnitude.</p>
<div id="selectivity" class="section level2" number="9.1">
<h2 number="9.1"><span class="header-section-number">9.1</span> Selectivity</h2>
<p>For a fleet block <span class="math inline">\(b\)</span> for which selectivity is estimated, then parameters <span class="math inline">\(x^{LFS}_b\)</span> and <span class="math inline">\(x^{L5}_b\)</span> are estimated over all real numbers, where</p>
<p><span class="math display">\[ \begin{align}
L^{\textrm{FS}}_b &amp;= 0.99 \times L_{\infty} \times \textrm{logit}^{-1}(x^{LFS}_b)\\
L^5_b &amp;= L^{\textrm{FS}}_b - \exp(x^{L5}_b) 
\end{align}\]</span></p>
<p>If a third parameter <span class="math inline">\(x^{V}_b\)</span>is estimated for dome selectivity, then <span class="math display">\[ V^{L_{\infty}}_b = \textrm{logit}^{-1}(x^V_b)\]</span></p>
<p>If selectivity is parameterized as free parameters, then <span class="math display">\[ v_{y,a,f} = \textrm{logit}^{-1}(x^v_{y,a,f}).\]</span></p>
<p>For surveys, parameterizations are identical except with indexing for survey <span class="math inline">\(s\)</span>.</p>
</div>
<div id="fishing-mortality" class="section level2" number="9.2">
<h2 number="9.2"><span class="header-section-number">9.2</span> Fishing mortality</h2>
<p>If <span class="math inline">\(F_{y,f}\)</span> are estimated parameters (<code>condition = &quot;catch&quot;</code>), then one parameter <span class="math inline">\(x^F_f\)</span> is the estimated <span class="math inline">\(F\)</span> in log-space in the middle of the time series is estimated and all others are subsequent deviations, represented as <span class="math inline">\(x^{F_{dev}}_{y,f}\)</span>:</p>
<p><span class="math display">\[ F_{y,f} = 
\begin{cases}
\exp(x^F_f) &amp; y \textrm{ is midpoint of the time series}\\ 
\exp(x^F_f) \times \exp(x^{F_{dev}}_{y,f}) &amp; \textrm{otherwise}\\
\end{cases}
\]</span></p>
<p>If <code>condition = &quot;effort&quot;</code>, then <span class="math inline">\(q_f\)</span> is estimated in log space, where <span class="math display">\[F_{y,f} = q_f E_{y,f} = \exp(x^q_f) \times E_{y,f}\]</span></p>
</div>
<div id="index-catchability" class="section level2" number="9.3">
<h2 number="9.3"><span class="header-section-number">9.3</span> Index catchability</h2>
<p>To scale biomass to index values, the index catchability <span class="math inline">\(q_s\)</span> is solved analytically in the model:</p>
<p><span class="math display">\[ q_s = \exp\left(\dfrac{\sum_y \log(I^{\textrm{obs}}_{y,s}) - \sum_y \log(\sum_a v_{y,a,s}N_{y,a,s})}{n_s}\right),\]</span> or <span class="math display">\[ q_s = \exp\left(\dfrac{\sum_y \log(I^{\textrm{obs}}_{y,s}) - \sum_y \log(\sum_a v_{y,a,s}N_{y,a,s}w_{y,a})}{n_s}\right),\]</span> for an abundance or biomass based index, respectively, where <span class="math inline">\(n_s\)</span> is the number of years with index values and the summation is over those <span class="math inline">\(n_s\)</span> years.</p>
</div>
<div id="other-parameters" class="section level2" number="9.4">
<h2 number="9.4"><span class="header-section-number">9.4</span> Other parameters</h2>
<p>Unfished recruitment is estimated in log-space, <span class="math inline">\(R_0 = \dfrac{1}{z}\exp(x^{R_0})\)</span> where <span class="math inline">\(z\)</span> is an optional rescaler, e.g. mean historical catch, to reduce the magnitude of the <span class="math inline">\(x^{R_0}\)</span> estimate. Recruitment deviations <span class="math inline">\(\delta_y\)</span> are directly estimated.</p>
</div>
</div>
<div id="additional-resources" class="section level1" number="10">
<h1 number="10"><span class="header-section-number">10</span> Additional resources</h1>
<p>The help file for <code>SRA_scope</code> will provide more information on the possible inputs for the model. The help file for the SRA class (obtained by typing <code>class?SRA</code> into the R console) describes the outputs from the function. An additional <a href="SRA_scope_sel.html">vignette</a> is available to describe set up of fleet and survey selectivity in the function call.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
